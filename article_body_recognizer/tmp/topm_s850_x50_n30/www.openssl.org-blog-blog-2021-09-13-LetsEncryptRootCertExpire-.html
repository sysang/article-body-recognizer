<!DOCTYPE html>
<html>
<head>

      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <script> var url = encodeURIComponent('https://www.openssl.org/blog/blog/2021/09/13/LetsEncryptRootCertExpire/');</script>

        <script> var body_html = 'PGJvZHk+IDxoZWFkZXIgPjxoZ3JvdXA+IDxoMT48YSA+T3BlblNTTCBCbG9nPC9hPjwvaDE+IDwvaGdyb3VwPiA8L2hlYWRlcj4gIDxkaXYgPiA8ZGl2ID4gPGRpdj4gPGFydGljbGUgPiA8aGVhZGVyPiA8aDEgPk9sZCBMZXTigJlzIEVuY3J5cHQgUm9vdCBDZXJ0aWZpY2F0ZSBFeHBpcmF0aW9uIGFuZCBPcGVuU1NMIDEuMC4yPC9oMT4gPHAgPiBQb3N0ZWQgYnkgVG9tw6HFoSBNcsOheiAsIDx0aW1lID5TZXAgMTN0aCwgMjAyMSA4OjAwIGFtPC90aW1lPiA8L3A+IDwvaGVhZGVyPiA8ZGl2ID48cD5UaGUgY3VycmVudGx5IHJlY29tbWVuZGVkIGNlcnRpZmljYXRlIGNoYWluIGFzIHByZXNlbnRlZCB0byBMZXTigJlzIEVuY3J5cHQgQUNNRSBjbGllbnRzIHdoZW4gbmV3IGNlcnRpZmljYXRlcyBhcmUgaXNzdWVkIGNvbnRhaW5zIGFuIGludGVybWVkaWF0ZSBjZXJ0aWZpY2F0ZSAoSVNSRyBSb290IFgxKSB0aGF0IGlzIHNpZ25lZCBieSBhbiBvbGQgRFNUIFJvb3QgQ0EgWDMgY2VydGlmaWNhdGUgdGhhdCBleHBpcmVzIG9uIDIwMjEtMDktMzAuIEluIHNvbWUgY2FzZXMgdGhlIE9wZW5TU0wgMS4wLjIgdmVyc2lvbiB3aWxsIHJlZ2FyZCB0aGUgY2VydGlmaWNhdGVzIGlzc3VlZCBieSB0aGUgTGV04oCZcyBFbmNyeXB0IENBIGFzIGhhdmluZyBhbiBleHBpcmVkIHRydXN0IGNoYWluLjwvcD4gPHA+U2VlIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGN1cnJlbnRseSBpc3N1ZWQgdHJ1c3QgY2hhaW5zIGF0IDxhID5MZXTigJlzIEVuY3J5cHQ8L2E+LjwvcD4gPHA+TW9zdCB1cC10by1kYXRlIENBIGNlcnQgdHJ1c3RlZCBidW5kbGVzLCBhcyBwcm92aWRlZCBieSBvcGVyYXRpbmcgc3lzdGVtcywgY29udGFpbiB0aGlzIHNvb24tdG8tYmUtZXhwaXJlZCBjZXJ0aWZpY2F0ZS4gVGhlIGN1cnJlbnQgQ0EgY2VydCBidW5kbGVzIGFsc28gY29udGFpbiBhbiBJU1JHIFJvb3QgWDEgc2VsZi1zaWduZWQgY2VydGlmaWNhdGUuIFRoaXMgbWVhbnMgdGhhdCBjbGllbnRzIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZSBjaGFpbnMgY2FuIGZpbmQgdGhlIGFsdGVybmF0aXZlIG5vbi1leHBpcmVkIHBhdGggdG8gdGhlIElTUkcgUm9vdCBYMSBzZWxmLXNpZ25lZCBjZXJ0aWZpY2F0ZSBpbiB0aGVpciB0cnVzdCBzdG9yZS48L3A+IDxwPlVuZm9ydHVuYXRlbHkgdGhpcyBkb2VzIG5vdCBhcHBseSB0byBPcGVuU1NMIDEuMC4yIHdoaWNoIGFsd2F5cyBwcmVmZXJzIHRoZSB1bnRydXN0ZWQgY2hhaW4gYW5kIGlmIHRoYXQgY2hhaW4gY29udGFpbnMgYSBwYXRoIHRoYXQgbGVhZHMgdG8gYW4gZXhwaXJlZCB0cnVzdGVkIHJvb3QgY2VydGlmaWNhdGUgKERTVCBSb290IENBIFgzKSwgaXQgd2lsbCBiZSBzZWxlY3RlZCBmb3IgdGhlIGNlcnRpZmljYXRlIHZlcmlmaWNhdGlvbiBhbmQgdGhlIGV4cGlyYXRpb24gd2lsbCBiZSByZXBvcnRlZC48L3A+IDxwPlRoZXNlIGFyZSBzb21lIHBvc3NpYmxlIHdvcmthcm91bmRzIHRvIHJlc29sdmUgdGhlIHByb2JsZW06PC9wPiA8aDI+V29ya2Fyb3VuZCAxIChvbiBjbGllbnRzIHdpdGggT3BlblNTTCAxLjAuMik8L2gyPiA8cD5KdXN0IHJlbW92ZSB0aGUgZXhwaXJlZCByb290IGNlcnRpZmljYXRlIChEU1QgUm9vdCBDQSBYMykgZnJvbSB0aGUgdHJ1c3Qgc3RvcmUgdXNlZCBieSB0aGUgT3BlblNTTCAxLjAuMiBUTFMgY2xpZW50IHRvIHZlcmlmeSB0aGUgaWRlbnRpdHkgb2YgVExTIHNlcnZlcnMuIElmIHRoZSBuZXcgSVNSRyBSb290IFgxIHNlbGYtc2lnbmVkIGNlcnRpZmljYXRlIGlzbuKAmXQgYWxyZWFkeSBpbiB0aGUgdHJ1c3Qgc3RvcmUsIGFkZCBpdC48L3A+IDxwPlRoZXJlIGlzIG5vIGRvd25zaWRlIHRvIHRoaXMgd29ya2Fyb3VuZCBhcGFydCBmcm9tIHRoZSBuZWVkIHRvIG1vZGlmeSBhbGwgdGhlIHBvdGVudGlhbCBPcGVuU1NMIDEuMC4yIFRMUyBjbGllbnQgaG9zdHMgdHJ1c3Qgc3RvcmVzLjwvcD4gPHA+VGhlIHJlbW92YWwgYW5kIGFkZGl0aW9uIG9mIGNlcnRpZmljYXRlcyBmcm9tL2ludG8gdGhlIHN5c3RlbSBjZXJ0aWZpY2F0ZSB0cnVzdCBzdG9yZXMgaXMgYSBoaWdobHkgc3BlY2lmaWMgb3BlcmF0aW9uIGRlcGVuZGluZyBvbiB0aGUgb3BlcmF0aW9uIHN5c3RlbS4gRm9yIGV4YW1wbGUsIG9uIExpbnV4IGJhc2VkIHN5c3RlbXMgd2hpY2ggbWFuYWdlIHN5c3RlbSBjZXJ0aWZpY2F0ZSB0cnVzdCBzdG9yZXMgd2l0aCB0aGUgY2EtY2VydGlmaWNhdGVzIHRvb2wsIGEgQ0EgY2VydGlmaWNhdGUgY2FuIGJlIHJlbW92ZWQgYnkgZmlyc3QgY29weWluZyB0aGUgY2VydGlmaWNhdGUgaW50byA8Y29kZT4vZXRjL3BraS9jYS10cnVzdC9zb3VyY2UvYmxhY2tsaXN0PC9jb2RlPiBkaXJlY3RvcnkgYW5kIGFkZGVkIGJ5IGNvcHlpbmcgaW50byB0aGUgPGNvZGU+L2V0Yy9wa2kvY2EtdHJ1c3Qvc291cmNlL2FuY2hvcnMgZGlyZWN0b3J5PC9jb2RlPi4gVGhlIHRydXN0IHN0b3JlIGlzIHRoZW4gdXBkYXRlZCBieSBydW5uaW5nIHRoZSA8Y29kZT51cGRhdGUtY2EtdHJ1c3Q8L2NvZGU+IGNvbW1hbmQuPC9wPiA8aDI+V29ya2Fyb3VuZCAyIChvbiBjbGllbnRzIHdpdGggT3BlblNTTCAxLjAuMik8L2gyPiA8cD5UaGUgPGNvZGU+LXRydXN0ZWRfZmlyc3Q8L2NvZGU+IG9wdGlvbiBzdXBwb3J0IGluIDxjb2RlPm9wZW5zc2wgdmVyaWZ5PC9jb2RlPiwgPGNvZGU+b3BlbnNzbCBzX2NsaWVudDwvY29kZT4sIGFuZCBvdGhlciBzaW1pbGFyIG9wZW5zc2wgY29tbWFuZHMgd2hlbiBhcHBsaWVkLCBvdmVycmlkZXMgdGhlIGNlcnRpZmljYXRlIGNoYWluIGJ1aWxkaW5nIHNvIGl0IHByZWZlcnMgdGhlIHRydXN0IHN0b3JlIGNlcnRpZmljYXRlcyBvdmVyIHRoZSB1bnRydXN0ZWQgY2VydGlmaWNhdGVzIGluIHRoZSBjaGFpbiBwcm92aWRlZCBieSB0aGUgcGVlci4gVGhhdCBlZmZlY3RpdmVseSBtZWFucyB0aGF0IHdpdGggdGhlIG9wdGlvbiBlbmFibGVkIHRoZSBwcm9ibGVtIGRvZXMgbm90IGhhcHBlbi48L3A+IDxwPkhvd2V2ZXIgdGhlIG9wdGlvbiBpcyBub3QgZW5hYmxlZCBieSBkZWZhdWx0IGFuZCB0aGlyZCBwYXJ0eSBhcHBsaWNhdGlvbnMgZG8gbm90IHVzdWFsbHkgcHJvdmlkZSBhIHdheSB0byBlbmFibGUgdGhpcyBvcHRpb24uIFRoZSBhcHBsaWNhdGlvbnMgd291bGQgaGF2ZSB0byBjYWxsIDxjb2RlPlg1MDlfVkVSSUZZX1BBUkFNX3NldF9mbGFncygpPC9jb2RlPiBmdW5jdGlvbiB3aXRoIHRoZSA8Y29kZT5YNTA5X1ZfRkxBR19UUlVTVEVEX0ZJUlNUPC9jb2RlPiBmbGFnIHRvIGVuYWJsZSB0aGlzIG9wdGlvbi48L3A+IDxwPlRoZSBuZXh0IHJlbGVhc2Ugb2YgT3BlblNTTCAxLjAuMiAoMS4wLjJ6YiAtIGF2YWlsYWJsZSB0byBwcmVtaXVtIHN1cHBvcnQgY3VzdG9tZXJzIG9ubHkpIHdpbGwgbWFrZSBpdCBwb3NzaWJsZSB0byBidWlsZCB0aGUgcmVsZWFzZSB3aXRoIGFkZGVkIDxjb2RlPi1ET1BFTlNTTF9UUlVTVEVEX0ZJUlNUX0RFRkFVTFQ8L2NvZGU+IG9uIHRoZSBidWlsZCBjb25maWd1cmF0aW9uIGNvbW1hbmQgbGluZS4gVGhhdCB3aWxsIG1ha2UgdGhlIDxjb2RlPi10cnVzdGVkX2ZpcnN0PC9jb2RlPiBvcHRpb24gZW5hYmxlZCBieSBkZWZhdWx0IGJ5IHRoZSBPcGVuU1NMIGxpYnJhcnkuPC9wPiA8aDI+V29ya2Fyb3VuZCAzIChvbiB0aGUgc2VydmVycyB0aGF0IDEuMC4yIGNsaWVudHMgY29ubmVjdCB0byk8L2gyPiA8cD5Db25maWd1cmUgdGhlIHNlcnZlciB0byB1c2UgdGhlIGFsdGVybmF0aXZlIGNlcnRpZmljYXRlIGNoYWluIHdoaWNoIGNhbiBiZSByZXF1ZXN0ZWQgZnJvbSBMZXTigJlzIEVuY3J5cHQgd2l0aCBtb3N0IHVwLXRvLWRhdGUgQUNNRSBwcm90b2NvbCBjbGllbnRzLiBUaGlzIGNoYWluIGRvZXMgbm90IGNvbnRhaW4gdGhlIElTUkcgUm9vdCBYMSBjcm9zcy1zaWduZWQgYnkgdGhlIHNvb24gdG8gYmUgZXhwaXJlZCBEU1QgUm9vdCBDQSBYMyBhbmQgdGh1cyBhbnkgT3BlblNTTCAxLjAuMiBjbGllbnRzIHdpbGwgbm90IGJlIG1pc2xlZCBieSB0aGlzIGV4cGlyZWQgcGF0aC48L3A+IDxwPlRoZSBkb3duc2lkZSBpcyB0aGF0IHRoZSBzZXJ2ZXJzIHdpbGwgYmUgc2VlbiBhcyB1c2luZyBhbiB1bnRydXN0ZWQgcm9vdCBjZXJ0aWZpY2F0ZSBieSBzb21lIG9sZGVyIEFuZHJvaWQgY2xpZW50cyBiZWNhdXNlIHRoZXNlIGNsaWVudHMgZG8gbm90IGNvbnRhaW4gdGhlIHNlbGYtc2lnbmVkIElTUkcgUm9vdCBYMSBjZXJ0aWZpY2F0ZSBpbiB0aGVpciB0cnVzdCBzdG9yZXMuPC9wPiA8L2Rpdj4gPC9hcnRpY2xlPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiA8L2JvZHk+'</script>

      </head>
        <body class="valid" valid="valid" title="valid: True, node: 1, tag: body, level: 1" node_number="1"> <header class="valid" valid="valid" title="valid: True, node: 2, tag: header, level: 2" node_number="2"><hgroup class="valid" valid="valid" title="valid: True, node: 3, tag: hgroup, level: 3" node_number="3"> <h1 class="valid" valid="valid" title="valid: True, node: 4, tag: h1, level: 4" node_number="4"><a class="valid" valid="valid" title="valid: True, node: 5, tag: a, level: 5" node_number="5">OpenSSL Blog</a></h1> </hgroup> </header>  <div class="valid" valid="valid" title="valid: True, node: 6, tag: div, level: 2" node_number="6"> <div class="valid" valid="valid" title="valid: True, node: 7, tag: div, level: 3" node_number="7"> <div class="valid" valid="valid" title="valid: True, node: 8, tag: div, level: 4" node_number="8"> <article class="valid" valid="valid" title="valid: True, node: 9, tag: article, level: 5" node_number="9"> <header class="valid" valid="valid" title="valid: True, node: 10, tag: header, level: 6" node_number="10"> <h1 class="valid" valid="valid" title="valid: True, node: 11, tag: h1, level: 7" node_number="11">Old Let&#8217;s Encrypt Root Certificate Expiration and OpenSSL 1.0.2</h1> <p class="valid" valid="valid" title="valid: True, node: 12, tag: p, level: 7" node_number="12"> Posted by Tom&#225;&#353; Mr&#225;z , <time class="valid" valid="valid" title="valid: True, node: 13, tag: time, level: 8" node_number="13">Sep 13th, 2021 8:00 am</time> </p> </header> <div class="valid" valid="valid" title="valid: True, node: 14, tag: div, level: 6" node_number="14"><p class="valid" valid="valid" title="valid: True, node: 15, tag: p, level: 7" node_number="15">The currently recommended certificate chain as presented to Let&#8217;s Encrypt ACME clients when new certificates are issued contains an intermediate certificate (ISRG Root X1) that is signed by an old DST Root CA X3 certificate that expires on 2021-09-30. In some cases the OpenSSL 1.0.2 version will regard the certificates issued by the Let&#8217;s Encrypt CA as having an expired trust chain.</p> <p class="valid" valid="valid" title="valid: True, node: 16, tag: p, level: 7" node_number="16">See more information about the currently issued trust chains at <a class="valid" valid="valid" title="valid: True, node: 17, tag: a, level: 8" node_number="17">Let&#8217;s Encrypt</a>.</p> <p class="valid" valid="valid" title="valid: True, node: 18, tag: p, level: 7" node_number="18">Most up-to-date CA cert trusted bundles, as provided by operating systems, contain this soon-to-be-expired certificate. The current CA cert bundles also contain an ISRG Root X1 self-signed certificate. This means that clients verifying certificate chains can find the alternative non-expired path to the ISRG Root X1 self-signed certificate in their trust store.</p> <p class="valid" valid="valid" title="valid: True, node: 19, tag: p, level: 7" node_number="19">Unfortunately this does not apply to OpenSSL 1.0.2 which always prefers the untrusted chain and if that chain contains a path that leads to an expired trusted root certificate (DST Root CA X3), it will be selected for the certificate verification and the expiration will be reported.</p> <p class="valid" valid="valid" title="valid: True, node: 20, tag: p, level: 7" node_number="20">These are some possible workarounds to resolve the problem:</p> <h2 class="valid" valid="valid" title="valid: True, node: 21, tag: h2, level: 7" node_number="21">Workaround 1 (on clients with OpenSSL 1.0.2)</h2> <p class="valid" valid="valid" title="valid: True, node: 22, tag: p, level: 7" node_number="22">Just remove the expired root certificate (DST Root CA X3) from the trust store used by the OpenSSL 1.0.2 TLS client to verify the identity of TLS servers. If the new ISRG Root X1 self-signed certificate isn&#8217;t already in the trust store, add it.</p> <p class="valid" valid="valid" title="valid: True, node: 23, tag: p, level: 7" node_number="23">There is no downside to this workaround apart from the need to modify all the potential OpenSSL 1.0.2 TLS client hosts trust stores.</p> <p class="valid" valid="valid" title="valid: True, node: 24, tag: p, level: 7" node_number="24">The removal and addition of certificates from/into the system certificate trust stores is a highly specific operation depending on the operation system. For example, on Linux based systems which manage system certificate trust stores with the ca-certificates tool, a CA certificate can be removed by first copying the certificate into <code class="valid" valid="valid" title="valid: True, node: 25, tag: code, level: 8" node_number="25">/etc/pki/ca-trust/source/blacklist</code> directory and added by copying into the <code class="valid" valid="valid" title="valid: True, node: 26, tag: code, level: 8" node_number="26">/etc/pki/ca-trust/source/anchors directory</code>. The trust store is then updated by running the <code class="valid" valid="valid" title="valid: True, node: 27, tag: code, level: 8" node_number="27">update-ca-trust</code> command.</p> <h2 class="valid" valid="valid" title="valid: True, node: 28, tag: h2, level: 7" node_number="28">Workaround 2 (on clients with OpenSSL 1.0.2)</h2> <p class="valid" valid="valid" title="valid: True, node: 29, tag: p, level: 7" node_number="29">The <code class="valid" valid="valid" title="valid: True, node: 30, tag: code, level: 8" node_number="30">-trusted_first</code> option support in <code class="valid" valid="valid" title="valid: True, node: 31, tag: code, level: 8" node_number="31">openssl verify</code>, <code class="valid" valid="valid" title="valid: True, node: 32, tag: code, level: 8" node_number="32">openssl s_client</code>, and other similar openssl commands when applied, overrides the certificate chain building so it prefers the trust store certificates over the untrusted certificates in the chain provided by the peer. That effectively means that with the option enabled the problem does not happen.</p> <p class="valid" valid="valid" title="valid: True, node: 33, tag: p, level: 7" node_number="33">However the option is not enabled by default and third party applications do not usually provide a way to enable this option. The applications would have to call <code class="valid" valid="valid" title="valid: True, node: 34, tag: code, level: 8" node_number="34">X509_VERIFY_PARAM_set_flags()</code> function with the <code class="valid" valid="valid" title="valid: True, node: 35, tag: code, level: 8" node_number="35">X509_V_FLAG_TRUSTED_FIRST</code> flag to enable this option.</p> <p class="valid" valid="valid" title="valid: True, node: 36, tag: p, level: 7" node_number="36">The next release of OpenSSL 1.0.2 (1.0.2zb - available to premium support customers only) will make it possible to build the release with added <code class="valid" valid="valid" title="valid: True, node: 37, tag: code, level: 8" node_number="37">-DOPENSSL_TRUSTED_FIRST_DEFAULT</code> on the build configuration command line. That will make the <code class="valid" valid="valid" title="valid: True, node: 38, tag: code, level: 8" node_number="38">-trusted_first</code> option enabled by default by the OpenSSL library.</p> <h2 class="valid" valid="valid" title="valid: True, node: 39, tag: h2, level: 7" node_number="39">Workaround 3 (on the servers that 1.0.2 clients connect to)</h2> <p class="valid" valid="valid" title="valid: True, node: 40, tag: p, level: 7" node_number="40">Configure the server to use the alternative certificate chain which can be requested from Let&#8217;s Encrypt with most up-to-date ACME protocol clients. This chain does not contain the ISRG Root X1 cross-signed by the soon to be expired DST Root CA X3 and thus any OpenSSL 1.0.2 clients will not be misled by this expired path.</p> <p class="valid" valid="valid" title="valid: True, node: 41, tag: p, level: 7" node_number="41">The downside is that the servers will be seen as using an untrusted root certificate by some older Android clients because these clients do not contain the self-signed ISRG Root X1 certificate in their trust stores.</p> </div> </article> </div> </div> </div> </body>
        <style tyle='text/css'>
body{
    position: relative;
    padding-left: 30px;
    top: 60px;
}
* {
    border: 1px solid #eee;
    padding: 5px 12px;
    margin: 3px 0;
    box-sizing: content-box;
    background-color: #fff;
    cursor: no-drop;
}
main:hover > *, section:hover > *, header:hover > *, nav:hover > *, a:hover > *, div:hover > *, p:hover > *, ul:hover > *, h1:hover > *, h2:hover > *, h3:hover > *, li:hover > *, span:hover > *{
    border: 2px solid green;
    background-color: #fffeee;
    padding: 5px 23px !important;
    margin: 1px 0;
    color: green;
}
main:hover, section:hover, header:hover, nav:hover, a:hover, div:hover, p:hover, ul:hover, h1:hover, h2:hover, h3:hover, li:hover, span:hover{
    border: 1px solid #fff;
    background-color: #eee;
}
a, span {
    display: block;
}
.selected {
    border: 2px solid orchid !important;
    opacity: 0.8;
    color: orchid !important;
}
.selected * {
    padding: 2px !important;
    color: orchid !important;
}
.valid {
  cursor: pointer;
}
.btn{
  cursor: pointer;
  font-weight: bolder;
  padding: 8px;
}
</style> 
        <script>function OpenOriginalLink($event){
    $event.stopPropagation();
    console.log(url);
}

function removeItem($event){
    $event.stopPropagation();
    console.log('Remove item: ', url)
    localStorage.removeItem(url)
}

function exportData($event){
    $event.stopPropagation();

    result = []
    for(let i=0; i<localStorage.length; i++) {
        let key = localStorage.key(i);
        result.push(localStorage.getItem(key))
    }
    const _url = URL.createObjectURL(new Blob([result.join("\n")], {type: 'text/plain'}))
    $event.target.href = _url;
    localStorage.clear()
}

var removeItemBtn = document.createElement("BUTTON");   // Create a <button> element
removeItemBtn.innerHTML = "Remove Item";
removeItemBtn.classList.add('btn');
removeItemBtn.style.position = "fixed";
removeItemBtn.style.left = '5px';
removeItemBtn.style.top = 0;
removeItemBtn.style.border = "1px solid";
removeItemBtn.style.boxShadow = "3px 3px #888";
removeItemBtn.onclick = removeItem;
document.body.appendChild(removeItemBtn);

var goToOriginLink = document.createElement("A");   // Create a <button> element
goToOriginLink.innerHTML = "GoToOrigin";
goToOriginLink.classList.add('btn');
goToOriginLink.style.position = "fixed"
goToOriginLink.style.left = '115px'
goToOriginLink.style.top = 0;
goToOriginLink.onclick = OpenOriginalLink;
goToOriginLink.setAttribute('href', decodeURIComponent(url));
goToOriginLink.target = '_blank';
document.body.appendChild(goToOriginLink);

var current = new Date
var exportDataLink = document.createElement("A");   // Create a <button> element
exportDataLink.innerHTML = "Export data";
exportDataLink.classList.add('btn');
exportDataLink.download = current.toISOString() + '.exported.txt';
exportDataLink.style.position = "fixed";
exportDataLink.style.right = '5px';
exportDataLink.style.top = 0;
exportDataLink.style.border = "1px solid #888";
exportDataLink.style.boxShadow = "3px 3px #888";
exportDataLink.onclick = exportData;
document.body.appendChild(exportDataLink);

data = {
    'title': null ,
    'article': null
}

var body = document.getElementsByTagName("body")[0];

body.onclick = function($e){
    var num = $e.target.getAttribute('node_number')
    var valid = $e.target.getAttribute('valid')

    if(!valid){
        console.log("Element is invalid")
        return
    }

    if(data.length > 2){
        data = data.splice(0, 2)
    }

    console.log("node:", $e.target)

    if(!data.title && !data.article){
        data.title = num;
        console.log("data:", data)
        $e.target.classList.add('selected')
    }else if (data.title && !data.article){
        data.article = num;
        console.log("data:", data)
        $e.target.classList.add('selected')
    }else{
        selected = Array.from(document.getElementsByClassName("selected"))
        selected.forEach(function(el){
            el.classList.remove('selected')
        })

        data.title = num;
        data.article = null;
        $e.target.classList.add('selected')

    }

    if(data.title && data.article){
        var obj = {
            url: url,
            text: body_html,
            title: data.title,
            article: data.article,
        }

        var datasetItem = JSON.stringify(obj)
        localStorage.setItem(url, datasetItem)
    }
}
</script> 
      </html>