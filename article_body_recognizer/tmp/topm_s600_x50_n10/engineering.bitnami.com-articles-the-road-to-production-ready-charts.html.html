<!DOCTYPE html>
<html>
<head>

      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <script> var url = encodeURIComponent('https://engineering.bitnami.com/articles/the-road-to-production-ready-charts.html');</script>

        <script> var body_html = 'PGJvZHkgPiA8ZGl2ID4gPGRpdiA+IDxoZWFkZXIgPiA8ZGl2ID4gPHVsID4gPGxpPiA8YSA+QXJ0aWNsZXM8L2E+IDwvbGk+IDwvdWw+IDxkaXYgPiA8YSA+IFJTUyBGZWVkIDwvYT48L2Rpdj4gPC9kaXY+IDwvaGVhZGVyPiA8L2Rpdj4gPC9kaXY+IDxtYWluPiA8ZGl2ID4gPGRpdiA+IDxoZWFkZXIgPiA8aDEgPiBUaGUgcm9hZCB0byBwcm9kdWN0aW9uIHJlYWR5IGNoYXJ0cyA8L2gxPiA8ZGl2ID4gPHAgPiBQdWJsaXNoZWQgYnkgPGI+IEphdmllciBKLiBTYWxtZXLDs24gPC9iPiBvbiA8dGltZT4gTWF5IDEzLCAyMDE5IDwvdGltZT4gPC9wPiA8ZGl2ID4gI2t1YmVybmV0ZXMgI2hlbG0gI2NoYXJ0cyAjcHJvZHVjdGlvbi1yZWFkeSAjc2VjdXJpdHkgI2VsYXN0aWNzZWFyY2ggI3JhYmJpdG1xICNwb3N0Z3Jlc3FsIDwvZGl2PiA8L2Rpdj4gPC9oZWFkZXI+IDwvZGl2PiA8ZGl2ID4gPGRpdiA+IDxwPlRocmVlIHllYXJzIGhhdmUgcGFzc2VkIHNpbmNlIDxhID50aGUgZmlyc3QgcmVsZWFzZSBvZiBIZWxtPC9hPiwgYW5kIGl0IGhhcyBpbmRlZWQgbWFkZSBhIG5hbWUgZm9yIGl0c2VsZi4gQm90aCBhdm93ZWQgZmFucyBhbmQgZmVydmVudCBoYXRlcnMgYWdyZWUgdGhhdCB0aGUgS3ViZXJuZXRlcyAiYXB0LWdldCBlcXVpdmFsZW50IiBpcyB0aGUgc3RhbmRhcmQgd2F5IG9mIGRlcGxveWluZyB0byBwcm9kdWN0aW9uIChhdCBsZWFzdCBmb3Igbm93LCBsZXQncyBzZWUgd2hhdCBPcGVyYXRvcnMgZW5kIHVwIGJyaW5naW5nIHRvIHRoZSB0YWJsZSkuIER1cmluZyB0aGlzIHRpbWUsIEJpdG5hbWkgaGFzIGNvbnRyaWJ1dGVkIHRvIHRoZSBwcm9qZWN0IGluIG1hbnkgd2F5cy4gWW91IGNhbiBmaW5kIHVzIGluIFBScyBpbiBIZWxtJ3MgY29kZSwgaW4gc29sdXRpb25zIGxpa2UgPGEgPkt1YmVhcHBzPC9hPiwgYW5kIGVzcGVjaWFsbHkgaW4gd2hhdCB3ZSBhcmUgbW9zdGx5IGtub3duIGZvcjogPGEgPm91ciBodWdlIGFwcGxpY2F0aW9uIGxpYnJhcnk8L2E+LjwvcD4gPHA+QXMgbWFpbnRhaW5lcnMgb2YgYSBjb2xsZWN0aW9uIG9mIG1vcmUgdGhhbiA8YSA+NDUgSGVsbSBjaGFydHM8L2E+LCB3ZSBrbm93IHRoYXQgY3JlYXRpbmcgYSBtYWludGFpbmFibGUsIHNlY3VyZSBhbmQgcHJvZHVjdGlvbi1yZWFkeSBjaGFydCBpcyBmYXIgZnJvbSB0cml2aWFsLiBJbiB0aGlzIHNlbnNlLCB0aGlzIGJsb2cgcG9zdCBzaG93cyBlc3NlbnRpYWwgZmVhdHVyZXMgdGhhdCBhbnkgY2hhcnQgZGV2ZWxvcGVyIHNob3VsZCBrbm93LjwvcD4gPGgzID5Vc2Ugbm9uLXJvb3QgY29udGFpbmVyczwvaDM+IDxwPkVuc3VyaW5nIHRoYXQgYSBjb250YWluZXIgaXMgYWJsZSB0byBwZXJmb3JtIG9ubHkgYSB2ZXJ5IGxpbWl0ZWQgc2V0IG9mIG9wZXJhdGlvbnMgaXMgdml0YWwgZm9yIHByb2R1Y3Rpb24gZGVwbG95bWVudHMuIFRoaXMgaXMgcG9zc2libGUgdGhhbmtzIHRvIHRoZSB1c2Ugb2Ygbm9uLXJvb3QgY29udGFpbmVycywgd2hpY2ggYXJlIGV4ZWN1dGVkIGJ5IGEgdXNlciBkaWZmZXJlbnQgZnJvbSByb290LiBBbHRob3VnaCBjcmVhdGluZyBhIG5vbi1yb290IGNvbnRhaW5lciBpcyBhIGJpdCBtb3JlIGNvbXBsZXggdGhhbiBhIHJvb3QgY29udGFpbmVyIChlc3BlY2lhbGx5IHJlZ2FyZGluZyBmaWxlc3lzdGVtIHBlcm1pc3Npb25zKSwgaXQgaXMgYWJzb2x1dGVseSB3b3J0aCBpdC4gQWxzbywgaW4gZW52aXJvbm1lbnRzIGxpa2UgT3BlbnNoaWZ0LCA8YSA+dXNpbmcgbm9uLXJvb3QgY29udGFpbmVycyBpcyBtYW5kYXRvcnk8L2E+LjwvcD4gPHA+SW4gb3JkZXIgdG8gbWFrZSB5b3VyIEhlbG0gY2hhcnQgd29yayB3aXRoIG5vbi1yb290IGNvbnRhaW5lcnMsIGFkZCB0aGUgPGEgPnNlY3VyaXR5Q29udGV4dDwvYT4gc2VjdGlvbiB0byB5b3VyIHlhbWwgZmlsZXMuPC9wPiA8cD5UaGlzIGlzIHdoYXQgd2UgZG8sIGZvciBpbnN0YW5jZSwgaW4gdGhlIEJpdG5hbWkgRWxhc3RpY3NlYXJjaCBIZWxtIGNoYXJ0LiBUaGlzIGNoYXJ0IGRlcGxveXMgc2V2ZXJhbCBFbGFzdGljc2VhcmNoIFN0YXRlZnVsU2V0cyBhbmQgRGVwbG95bWVudHMgKGRhdGEsIGluZ2VzdGlvbiwgY29vcmRpbmF0aW5nIGFuZCBtYXN0ZXIgbm9kZXMpLCBhbGwgb2YgdGhlbSB3aXRoIG5vbi1yb290IGNvbnRhaW5lcnMuIElmIHdlIGNoZWNrIHRoZSA8YSA+bWFzdGVyIG5vZGUgU3RhdGVmdWxTZXQ8L2E+LCB3ZSBzZWUgdGhlIGZvbGxvd2luZzo8L3A+IDxkaXYgPjxwcmUgPjxjb2RlPnNwZWM6IHt7LSBpZiAuVmFsdWVzLnNlY3VyaXR5Q29udGV4dC5lbmFibGVkIH19IHNlY3VyaXR5Q29udGV4dDogZnNHcm91cDoge3sgLlZhbHVlcy5zZWN1cml0eUNvbnRleHQuZnNHcm91cCB9fSB7ey0gZW5kIH19IDwvY29kZT48L3ByZT48L2Rpdj4gPHA+VGhlIHNuaXBwZXQgYWJvdmUgY2hhbmdlcyB0aGUgcGVybWlzc2lvbnMgb2YgdGhlIG1vdW50ZWQgdm9sdW1lcywgc28gdGhlIGNvbnRhaW5lciB1c2VyIGNhbiBhY2Nlc3MgdGhlbSBmb3IgcmVhZC93cml0ZSBvcGVyYXRpb25zLiBJbiBhZGRpdGlvbiB0byB0aGlzLCBpbnNpZGUgdGhlIGNvbnRhaW5lciBkZWZpbml0aW9uLCB3ZSBzZWUgYW5vdGhlciBzZWN1cml0eUNvbnRleHQgYmxvY2s6PC9wPiA8ZGl2ID48cHJlID48Y29kZT57ey0gaWYgLlZhbHVlcy5zZWN1cml0eUNvbnRleHQuZW5hYmxlZCB9fSBzZWN1cml0eUNvbnRleHQ6IHJ1bkFzVXNlcjoge3sgLlZhbHVlcy5zZWN1cml0eUNvbnRleHQucnVuQXNVc2VyIH19IHt7LSBlbmQgfX0gPC9jb2RlPjwvcHJlPjwvZGl2PiA8cD5JbiB0aGlzIHBhcnQgd2Ugc3BlY2lmeSB0aGUgdXNlciBydW5uaW5nIHRoZSBjb250YWluZXIuIEluIHRoZSB2YWx1ZXMueWFtbCBmaWxlIHdlIHNldCB0aGUgZGVmYXVsdCB2YWx1ZXMgZm9yIHRoZXNlIHBhcmFtZXRlcnM6PC9wPiA8ZGl2ID48cHJlID48Y29kZT4jIyBQb2QgU2VjdXJpdHkgQ29udGV4dCAjIyByZWY6IGh0dHBzOi8va3ViZXJuZXRlcy5pby9kb2NzL3Rhc2tzL2NvbmZpZ3VyZS1wb2QtY29udGFpbmVyL3NlY3VyaXR5LWNvbnRleHQvICMjIHNlY3VyaXR5Q29udGV4dDogZW5hYmxlZDogdHJ1ZSBmc0dyb3VwOiAxMDAxIHJ1bkFzVXNlcjogMTAwMSA8L2NvZGU+PC9wcmU+PC9kaXY+IDxwPldpdGggdGhlc2UgY2hhbmdlcywgdGhlIGNoYXJ0IHdpbGwgd29yayBhcyBub24tcm9vdCBpbiBwbGF0Zm9ybXMgbGlrZSBHS0UsIE1pbmlrdWJlIG9yIE9wZW5zaGlmdC48L3A+IDxoMyA+RG8gbm90IHBlcnNpc3QgdGhlIGNvbmZpZ3VyYXRpb248L2gzPiA8cD5BZGRpbmcgcGVyc2lzdGVuY2UgaXMgYW4gZXNzZW50aWFsIHBhcnQgb2YgZGVwbG95aW5nIHN0YXRlZnVsIGFwcGxpY2F0aW9ucy4gSW4gb3VyIGV4cGVyaWVuY2UsIGRlY2lkaW5nIHdoYXQgb3Igd2hhdCBub3QgdG8gcGVyc2lzdCBjYW4gYmUgdHJpY2t5LiBBZnRlciBzZXZlcmFsIGl0ZXJhdGlvbnMgaW4gb3VyIGNoYXJ0cywgd2UgZm91bmQgdGhhdCBwZXJzaXN0aW5nIHRoZSBhcHBsaWNhdGlvbiBjb25maWd1cmF0aW9uIGlzIG5vdCBhIHJlY29tbWVuZGVkIHByYWN0aWNlLiBPbmUgYWR2YW50YWdlIG9mIEt1YmVybmV0ZXMgaXMgdGhhdCB5b3UgY2FuIGNoYW5nZSB0aGUgZGVwbG95bWVudCBwYXJhbWV0ZXJzIHZlcnkgZWFzaWx5IGJ5IGp1c3QgZG9pbmcgPGNvZGU+a3ViZWN0bCBlZGl0IGRlcGxveW1lbnQ8L2NvZGU+IG9yIDxjb2RlPmhlbG0gdXBncmFkZTwvY29kZT4uIElmIHRoZSBjb25maWd1cmF0aW9uIGlzIHBlcnNpc3RlZCwgbm9uZSBvZiB0aGUgY2hhbmdlcyB3b3VsZCBiZSBhcHBsaWVkLiBTbywgd2hlbiBkZXZlbG9waW5nIGEgcHJvZHVjdGlvbi1yZWFkeSBIZWxtIGNoYXJ0LCBtYWtlIHN1cmUgdGhhdCB0aGUgY29uZmlndXJhdGlvbiBjYW4gYmUgZWFzaWx5IGNoYW5nZWQgd2l0aCA8Y29kZT5rdWJlY3RsPC9jb2RlPiBvciA8Y29kZT5oZWxtIHVwZ3JhZGU8L2NvZGU+LiBPbmUgY29tbW9uIHByYWN0aWNlIGlzIHRvIGNyZWF0ZSBhIENvbmZpZ01hcCB3aXRoIHRoZSBjb25maWd1cmF0aW9uIGFuZCBoYXZlIGl0IG1vdW50ZWQgaW4gdGhlIGNvbnRhaW5lci4gTGV0J3MgdXNlIHRoZSBCaXRuYW1pIFJhYmJpdE1RIGNoYXJ0IGFzIGFuIGV4YW1wbGU6PC9wPiA8ZGl2ID48cHJlID48Y29kZT5hcGlWZXJzaW9uOiB2MSBraW5kOiBDb25maWdNYXAgbWV0YWRhdGE6IG5hbWU6IHt7IHRlbXBsYXRlICJyYWJiaXRtcS5mdWxsbmFtZSIgLiB9fS1jb25maWcgbGFiZWxzOiBhcHA6IHt7IHRlbXBsYXRlICJyYWJiaXRtcS5uYW1lIiAuIH19IGNoYXJ0OiB7eyB0ZW1wbGF0ZSAicmFiYml0bXEuY2hhcnQiIC4gfX0gcmVsZWFzZTogInt7LlJlbGVhc2UuTmFtZX19IiBoZXJpdGFnZTogInt7LlJlbGVhc2UuU2VydmljZSB9fSIgZGF0YTogZW5hYmxlZF9wbHVnaW5zOiB8LSB7eyB0ZW1wbGF0ZSAicmFiYml0bXEucGx1Z2lucyIgLiB9fSByYWJiaXRtcS5jb25mOiB8LSAjI3VzZXJuYW1lIGFuZCBwYXNzd29yZCBkZWZhdWx0X3VzZXI9e3suVmFsdWVzLnJhYmJpdG1xLnVzZXJuYW1lfX0gZGVmYXVsdF9wYXNzPUNIQU5HRU1FIHt7IC5WYWx1ZXMucmFiYml0bXEuY29uZmlndXJhdGlvbiB8IGluZGVudCA0IH19IHt7IC5WYWx1ZXMucmFiYml0bXEuZXh0cmFDb25maWd1cmF0aW9uIHwgaW5kZW50IDQgfX0gPC9jb2RlPjwvcHJlPjwvZGl2PiA8cD5Ob3RlIHRoYXQgdGhlcmUgaXMgYSBzZWN0aW9uIGluIHRoZSB2YWx1ZXMueWFtbCBmaWxlIHRoYXQgYWxsb3dzIHlvdSB0byBpbmNsdWRlIGFueSBjdXN0b20gY29uZmlndXJhdGlvbjo8L3A+IDxkaXYgPjxwcmUgPjxjb2RlPiAjIyBDb25maWd1cmF0aW9uIGZpbGUgY29udGVudDogcmVxdWlyZWQgY2x1c3RlciBjb25maWd1cmF0aW9uICMjIERvIG5vdCBvdmVycmlkZSB1bmxlc3MgeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nLiBUbyBhZGQgbW9yZSBjb25maWd1cmF0aW9uLCB1c2UgYGV4dHJhQ29uZmlndXJhdGlvbmAgaW5zdGVhZCBjb25maWd1cmF0aW9uOiB8LSAjIyBDbHVzdGVyaW5nIGNsdXN0ZXJfZm9ybWF0aW9uLnBlZXJfZGlzY292ZXJ5X2JhY2tlbmQgPSByYWJiaXRfcGVlcl9kaXNjb3ZlcnlfazhzIGNsdXN0ZXJfZm9ybWF0aW9uLms4cy5ob3N0ID0ga3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIGNsdXN0ZXJfZm9ybWF0aW9uLm5vZGVfY2xlYW51cC5pbnRlcnZhbCA9IDEwIGNsdXN0ZXJfZm9ybWF0aW9uLm5vZGVfY2xlYW51cC5vbmx5X2xvZ193YXJuaW5nID0gdHJ1ZSBjbHVzdGVyX3BhcnRpdGlvbl9oYW5kbGluZyA9IGF1dG9oZWFsICMgcXVldWUgbWFzdGVyIGxvY2F0b3IgcXVldWVfbWFzdGVyX2xvY2F0b3I9bWluLW1hc3RlcnMgIyBlbmFibGUgZ3Vlc3QgdXNlciBsb29wYmFja191c2Vycy5ndWVzdCA9IGZhbHNlICMjIENvbmZpZ3VyYXRpb24gZmlsZSBjb250ZW50OiBleHRyYSBjb25maWd1cmF0aW9uICMjIFVzZSB0aGlzIGluc3RlYWQgb2YgYGNvbmZpZ3VyYXRpb25gIHRvIGFkZCBtb3JlIGNvbmZpZ3VyYXRpb24gZXh0cmFDb25maWd1cmF0aW9uOiB8LSAjZGlza19mcmVlX2xpbWl0LmFic29sdXRlID0gNTBNQiAjbWFuYWdlbWVudC5sb2FkX2RlZmluaXRpb25zID0gL2FwcC9sb2FkX2RlZmluaXRpb24uanNvbiA8L2NvZGU+PC9wcmU+PC9kaXY+IDxwPlRoaXMgQ29uZmlnTWFwIHRoZW4gZ2V0cyBtb3VudGVkIGluIHRoZSBjb250YWluZXIgZmlsZXN5c3RlbSwgYXMgd2UgY2FuIHNlZSBpbiB0aGUgU3RhdGVmdWxTZXQgc3BlYzo8L3A+IDxkaXYgPjxwcmUgPjxjb2RlPnZvbHVtZXM6IC0gbmFtZTogY29uZmlnLXZvbHVtZSBjb25maWdNYXA6IG5hbWU6IHt7IHRlbXBsYXRlICJyYWJiaXRtcS5mdWxsbmFtZSIgLiB9fS1jb25maWcgaXRlbXM6IC0ga2V5OiByYWJiaXRtcS5jb25mIHBhdGg6IHJhYmJpdG1xLmNvbmYgLSBrZXk6IGVuYWJsZWRfcGx1Z2lucyBwYXRoOiBlbmFibGVkX3BsdWdpbnMgPC9jb2RlPjwvcHJlPjwvZGl2PiA8cD5JZiB0aGUgYXBwbGljYXRpb24gbmVlZHMgdG8gd3JpdGUgaW4gdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSwgdGhlbiB5b3UnbGwgbmVlZCB0byBjcmVhdGUgYSBjb3B5IGluc2lkZSB0aGUgY29udGFpbmVyLCBhcyBDb25maWdNYXBzIGFyZSBtb3VudGVkIGFzIHJlYWQtb25seS4gVGhpcyBpcyBkb25lIGluIHRoZSBSYWJiaXRNUSBkZXBsb3ltZW50IGFzIHdlbGw6PC9wPiA8ZGl2ID48cHJlID48Y29kZT5jb250YWluZXJzOiAtIG5hbWU6IHJhYmJpdG1xIGltYWdlOiB7eyB0ZW1wbGF0ZSAicmFiYml0bXEuaW1hZ2UiIC4gfX0gaW1hZ2VQdWxsUG9saWN5OiB7eyAuVmFsdWVzLmltYWdlLnB1bGxQb2xpY3kgfCBxdW90ZSB9fSBjb21tYW5kOiAtIGJhc2ggLSAtZWMgLSB8IG1rZGlyIC1wIC9vcHQvYml0bmFtaS9yYWJiaXRtcS8ucmFiYml0bXEvIG1rZGlyIC1wIC9vcHQvYml0bmFtaS9yYWJiaXRtcS9ldGMvcmFiYml0bXEvICNwZXJzaXN0IHRoZSBlcmxhbmcgY29va2llIGluIGJvdGggcGxhY2VzIGZvciBzZXJ2ZXIgYW5kIGNsaSB0b29scyBlY2hvICRSQUJCSVRNUV9FUkxfQ09PS0lFICZndDsgL29wdC9iaXRuYW1pL3JhYmJpdG1xL3Zhci9saWIvcmFiYml0bXEvLmVybGFuZy5jb29raWUgY3AgL29wdC9iaXRuYW1pL3JhYmJpdG1xL3Zhci9saWIvcmFiYml0bXEvLmVybGFuZy5jb29raWUgL29wdC9iaXRuYW1pL3JhYmJpdG1xLy5yYWJiaXRtcS8gI2NoYW5nZSBwZXJtaXNzaW9uIHNvIG9ubHkgdGhlIHVzZXIgaGFzIGFjY2VzcyB0byB0aGUgY29va2llIGZpbGUgY2htb2QgNjAwIC9vcHQvYml0bmFtaS9yYWJiaXRtcS8ucmFiYml0bXEvLmVybGFuZy5jb29raWUgL29wdC9iaXRuYW1pL3JhYmJpdG1xL3Zhci9saWIvcmFiYml0bXEvLmVybGFuZy5jb29raWUgI2NvcHkgdGhlIG1vdW50ZWQgY29uZmlndXJhdGlvbiB0byBib3RoIHBsYWNlcyBjcCAvb3B0L2JpdG5hbWkvcmFiYml0bXEvY29uZi8qIC9vcHQvYml0bmFtaS9yYWJiaXRtcS9ldGMvcmFiYml0bXEgIyBBcHBseSByZXNvdXJjZXMgbGltaXRzIHVsaW1pdCAtbiAiJHtSQUJCSVRNUV9VTElNSVRfTk9GSUxFU30iICNyZXBsYWNlIHRoZSBkZWZhdWx0IHBhc3N3b3JkIHRoYXQgaXMgZ2VuZXJhdGVkIHNlZCAtaSAicy9DSEFOR0VNRS8kUkFCQklUTVFfUEFTU1dPUkQvZyIgL29wdC9iaXRuYW1pL3JhYmJpdG1xL2V0Yy9yYWJiaXRtcS9yYWJiaXRtcS5jb25mIDwvY29kZT48L3ByZT48L2Rpdj4gPHA+VGhpcyB3aWxsIG1ha2UgeW91ciBjaGFydCBub3Qgb25seSBlYXN5IHRvIHVwZ3JhZGUsIGJ1dCBhbHNvIG1vcmUgYWRhcHRhYmxlIHRvIHVzZXIgbmVlZHMsIGFzIHRoZXkgY2FuIHByb3ZpZGUgdGhlaXIgY3VzdG9tIGNvbmZpZ3VyYXRpb24gZmlsZS48L3A+IDxoMyA+SW50ZWdyYXRlIGNoYXJ0cyB3aXRoIGxvZ2dpbmcgYW5kIG1vbml0b3JpbmcgdG9vbHM8L2gzPiA8cD5JZiB3ZSBhcmUgdGFsa2luZyBhYm91dCBwcm9kdWN0aW9uIGVudmlyb25tZW50cywgd2UgYXJlIHRhbGtpbmcgYWJvdXQgb2JzZXJ2YWJpbGl0eS4gSXQgaXMgZXNzZW50aWFsIGhhdmluZyBvdXIgZGVwbG95bWVudHMgcHJvcGVybHkgbW9uaXRvcmVkIHNvIHdlIGNhbiBlYXJseSBkZXRlY3QgcG90ZW50aWFsIGlzc3Vlcy4gSXQgYWxzbyBlc3NlbnRpYWwgdG8gaGF2ZSBhcHBsaWNhdGlvbiB1c2FnZSwgY29zdCBhbmQgcmVzb3VyY2UgY29uc3VtcHRpb24gbWV0cmljcy4gSW4gb3JkZXIgdG8gZ2F0aGVyIHRoaXMgaW5mb3JtYXRpb24sIHlvdSB3b3VsZCBjb21tb25seSBkZXBsb3kgbG9nZ2luZyBzdGFja3MgbGlrZSBFRksgKEVsYXN0aWNTZWFyY2gsIEZsdWVudGQsIGFuZCBLaWJhbmEpIGFuZCBtb25pdG9yaW5nIHRvb2xzIGxpa2UgUHJvbWV0aGV1cy4gQml0bmFtaSBvZmZlcnMgdGhlIEJpdG5hbWkgS3ViZXJuZXRlcyBQcm9kdWN0aW9uIFJ1bnRpbWUgKEJLUFIpIHRoYXQgZWFzaWx5IGluc3RhbGxzIHRoZXNlIHRvb2xzIChhbG9uZyB3aXRoIG90aGVycykgc28geW91ciBjbHVzdGVyIGlzIHJlYWR5IHRvIGhhbmRsZSBwcm9kdWN0aW9uIHdvcmtsb2Fkcy48L3A+IDxwPldoZW4gd3JpdGluZyB5b3VyIGNoYXJ0LCBtYWtlIHN1cmUgdGhhdCB5b3VyIGRlcGxveW1lbnQgaXMgYWJsZSB0byB3b3JrIHdpdGggdGhlIGFib3ZlIHRvb2xzIHNlYW1sZXNzbHkuIFRvIGRvIHNvLCBlbnN1cmUgdGhlIGZvbGxvd2luZzo8L3A+IDx1bD4gPGxpPkFsbCB0aGUgY29udGFpbmVycyBsb2cgdG8gc3Rkb3V0L3N0ZGVyciAoc28gdGhlIEVGSyBzdGFjayBjYW4gZWFzaWx5IGluZ2VzdCBhbGwgdGhlIGxvZ2dpbmcgaW5mb3JtYXRpb24pPC9saT4gPGxpPlByb21ldGhldXMgZXhwb3J0ZXJzIGFyZSBpbmNsdWRlZCAoZWl0aGVyIHVzaW5nIHNpZGVjYXIgY29udGFpbmVycyBvciBoYXZpbmcgYSBzZXBhcmF0ZSBkZXBsb3ltZW50KTwvbGk+IDwvdWw+IDxwPkFsbCBCaXRuYW1pIGNoYXJ0cyB3b3JrIHdpdGggQktQUiAod2hpY2ggaW5jbHVkZXMgRUZLIGFuZCBQcm9tZXRoZXVzKSBvdXQgb2YgdGhlIGJveC4gTGV0J3MgdGFrZSBhIGxvb2sgYXQgdGhlIEJpdG5hbWkgUG9zdGdyZVNRTCBjaGFydCBhbmQgQml0bmFtaSBQb3N0Z3JlU1FMIGNvbnRhaW5lciB0byBzZWUgaG93IHdlIGRpZCBpdC48L3A+IDxwPlRvIGJlZ2luIHdpdGgsIHRoZSBwcm9jZXNzIGluc2lkZSB0aGUgY29udGFpbmVyIHJ1bnMgYXQgdGhlIGZvcmVncm91bmQsIHNvIGFsbCB0aGUgbG9nZ2luZyBpbmZvcm1hdGlvbiBpcyB3cml0dGVuIGluIHN0ZG91dC9zdGRlcnI6PC9wPiA8ZGl2ID48cHJlID48Y29kZT5TVEFSVF9BUkdTPSgiLUQiICIkREFUQV9ESVIiICItLWNvbmZpZy1maWxlPSRDT05GX0ZJTEUiICItLWV4dGVybmFsX3BpZF9maWxlPSRQSURfRklMRSIgIi0taGJhX2ZpbGU9JFBHX0hCQV9GSUxFIikgU1RPUF9BUkdTPSgic3RvcCIgIi13IiAiLUQiICIkREFUQV9ESVIiKSBmdW5jdGlvbiBwb3N0Z3Jlc3FsU3RhcnQgeyAjIElmIGNvbnRhaW5lciBpcyBzdGFydGVkIGFzIGByb290YCB1c2VyIGlmIFsgJEVVSUQgLWVxIDAgXTsgdGhlbiBleGVjIGdvc3UgcG9zdGdyZXMgcG9zdGdyZXMgIiR7U1RBUlRfQVJHU1tAXX0iIGVsc2UgZXhlYyBwb3N0Z3JlcyAiJHtTVEFSVF9BUkdTW0BdfSIgZmkgfSA8L2NvZGU+PC9wcmU+PC9kaXY+IDxwPldpdGggdGhpcywgd2UgZW5zdXJlZCB0aGF0IGl0IHdvcmtzIHdpdGggRUZLLiBUaGVuLCBpbiB0aGUgY2hhcnQgd2UgYWRkZWQgYSBzaWRlY2FyIGNvbnRhaW5lciBmb3IgdGhlIFByb21ldGhldXMgbWV0cmljczo8L3A+IDxkaXYgPjxwcmUgPjxjb2RlPnt7LSBpZiAuVmFsdWVzLm1ldHJpY3MuZW5hYmxlZCB9fSAtIG5hbWU6IG1ldHJpY3MgaW1hZ2U6IHt7IHRlbXBsYXRlICJwb3N0Z3Jlc3FsLm1ldHJpY3MuaW1hZ2UiIC4gfX0gaW1hZ2VQdWxsUG9saWN5OiB7eyAuVmFsdWVzLm1ldHJpY3MuaW1hZ2UucHVsbFBvbGljeSB8IHF1b3RlIH19IHt7LSBpZiAuVmFsdWVzLm1ldHJpY3Muc2VjdXJpdHlDb250ZXh0LmVuYWJsZWQgfX0gc2VjdXJpdHlDb250ZXh0OiBydW5Bc1VzZXI6IHt7IC5WYWx1ZXMubWV0cmljcy5zZWN1cml0eUNvbnRleHQucnVuQXNVc2VyIH19IHt7LSBlbmQgfX0gZW52OiB7ey0gJGRhdGFiYXNlIDo9IHJlcXVpcmVkICJJbiBvcmRlciB0byBlbmFibGUgbWV0cmljcyB5b3UgbmVlZCB0byBzcGVjaWZ5IGEgZGF0YWJhc2UgKC5WYWx1ZXMucG9zdGdyZXNxbERhdGFiYXNlIG9yIC5WYWx1ZXMuZ2xvYmFsLnBvc3RncmVzcWwucG9zdGdyZXNxbERhdGFiYXNlKSIgKGluY2x1ZGUgInBvc3RncmVzcWwuZGF0YWJhc2UiIC4pIH19IC0gbmFtZTogREFUQV9TT1VSQ0VfVVJJIHZhbHVlOiB7eyBwcmludGYgIjEyNy4wLjAuMTolZC8lcz9zc2xtb2RlPWRpc2FibGUiIChpbnQgKGluY2x1ZGUgInBvc3RncmVzcWwucG9ydCIgLikpICRkYXRhYmFzZSB8IHF1b3RlIH19IDwvY29kZT48L3ByZT48L2Rpdj4gPHA+V2UgYWxzbyBtYWRlIHN1cmUgdGhhdCB0aGUgcG9kcyBvciBzZXJ2aWNlcyBjb250YWluIHRoZSBwcm9wZXIgYW5ub3RhdGlvbnMgdGhhdCBQcm9tZXRoZXVzIHVzZXMgdG8gZGV0ZWN0IGV4cG9ydGVycy4gSW4gdGhpcyBjYXNlLCB3ZSBkZWZpbmVkIHRoZW0gaW4gdGhlIHZhbHVlcy55YW1sIGZpbGU6PC9wPiA8ZGl2ID48cHJlID48Y29kZT4jIyBDb25maWd1cmUgbWV0cmljcyBleHBvcnRlciAjIyBtZXRyaWNzOiBlbmFibGVkOiB0cnVlICMgcmVzb3VyY2VzOiB7fSBzZXJ2aWNlOiB0eXBlOiBDbHVzdGVySVAgYW5ub3RhdGlvbnM6IHByb21ldGhldXMuaW8vc2NyYXBlOiAidHJ1ZSIgcHJvbWV0aGV1cy5pby9wb3J0OiAiOTE4NyIgPC9jb2RlPjwvcHJlPjwvZGl2PiA8cD5JbiB0aGUgY2FzZSBvZiB0aGUgUG9zdGdyZVNRTCBjaGFydCwgdGhlc2UgYW5ub3RhdGlvbnMgZ28gdG8gYSA8YSA+bWV0cmljcyBzZXJ2aWNlPC9hPiwgc2VwYXJhdGUgZnJvbSB0aGUgUG9zdGdyZVNRTCBzZXJ2aWNlLjwvcD4gPHA+V2l0aCB0aGVzZSBtb2RpZmljYXRpb25zLCB5b3VyIGNoYXJ0IHdpbGwgc2VhbWxlc3NseSBpbnRlZ3JhdGUgd2l0aCB5b3VyIG1vbml0b3JpbmcgcGxhdGZvcm0uIEFsbCB0aGUgb2J0YWluZWQgbWV0cmljcyB3aWxsIGJlIGNydWNpYWwgZm9yIG1haW50YWluaW5nIHRoZSBkZXBsb3ltZW50IGluIGdvb2Qgc2hhcGUuPC9wPiA8aDMgPlByb2R1Y3Rpb24gd29ya2xvYWRzIGluIEt1YmVybmV0ZXMgYXJlIHBvc3NpYmxlPC9oMz4gPHA+Tm93IHlvdSBrbm93IHNvbWUgZXNzZW50aWFsIGd1aWRlbGluZXMgZm9yIGNyZWF0aW5nIHNlY3VyZWQgKHdpdGggbm9uLXJvb3QgY29udGFpbmVycyksIGFkYXB0YWJsZSAod2l0aCBwcm9wZXIgY29uZmlndXJhdGlvbiBtYW5hZ2VtZW50KSwgYW5kIG9ic2VydmFibGUgKHdpdGggcHJvcGVyIG1vbml0b3JpbmcpIGNoYXJ0cy4gV2l0aCB0aGVzZSBmZWF0dXJlcywgeW91IGhhdmUgY292ZXJlZCB0aGUgYmFzaWNzIHRvIGVuc3VyZSB0aGF0IHlvdXIgYXBwbGljYXRpb24gY2FuIGJlIGRlcGxveWVkIHRvIHByb2R1Y3Rpb24uIEhvd2V2ZXIsIHRoaXMgaXMganVzdCBhbm90aGVyIHN0ZXAgaW4geW91ciBqb3VybmV5IHRvIG1hc3RlcmluZyBIZWxtLiBZb3Ugc2hvdWxkIGFsc28gdGFrZSBpbnRvIGFjY291bnQgb3RoZXIgZmVhdHVyZXMgbGlrZSB1cGdyYWRhYmlsaXR5LCB1c2FiaWxpdHksIHN0YWJpbGl0eSBhbmQgdGVzdGluZy48L3A+IDxoMyA+VXNlZnVsIExpbmtzPC9oMz4gPHA+VG8gbGVhcm4gbW9yZSwgY2hlY2sgdGhlIGZvbGxvd2luZyBsaW5rczo8L3A+IDx1bD4gPGxpPjxhID5PZmZpY2lhbCBIZWxtIGNoYXJ0IGdvb2QgcHJhY3RpY2UgZ3VpZGVsaW5lczwvYT48L2xpPiA8bGk+PGEgPkhlbG0gYmVzdCBwcmFjdGljZXMgYnkgQ29kZUZyZXNoPC9hPjwvbGk+IDxsaT48YSA+Qml0bmFtaSBLdWJlcm5ldGVzIFByb2R1Y3Rpb24gUnVudGltZTwvYT48L2xpPiA8bGk+PGEgPkJpdG5hbWkgSGVsbSBjaGFydHMgbGlicmFyeSBpbiBHaXRodWI8L2E+PC9saT4gPGxpPjxhID5LdWJlYXBwcyBIdWI8L2E+PC9saT4gPC91bD4gPGRpdiA+IDxhID5NZWV0IHVzIGF0IEt1YmVDb248L2E+IDwvZGl2PiA8L2Rpdj4gPGRpdiA+IDxwPkRpZCB5b3UgbGlrZSB0aGlzIGFydGljbGU/IFNoYXJlIGl0IHdpdGggeW91ciBmcmllbmRzLjwvcD4gPHVsID4gPGxpPiA8YSA+KG5vdCBmb3VuZCkgPC9hPjwvbGk+IDwvdWw+IDwvZGl2PiA8ZGl2ID4gPGgzPkFib3V0IHRoZSBhdXRob3I8L2gzPiA8ZGl2ID4gPGgyID4gSmF2aWVyIEouIFNhbG1lcsOzbiA8L2gyPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gPC9tYWluPiA8L2JvZHk+'</script>

      </head>
        <body class="valid" valid="valid" title="valid: True, node: 1, tag: body, level: 1" node_number="1"> <div class="valid" valid="valid" title="valid: True, node: 2, tag: div, level: 2" node_number="2"> <div class="valid" valid="valid" title="valid: True, node: 3, tag: div, level: 3" node_number="3"> <header class="valid" valid="valid" title="valid: True, node: 4, tag: header, level: 4" node_number="4"> <div class="valid" valid="valid" title="valid: True, node: 5, tag: div, level: 5" node_number="5"> <ul class="valid" valid="valid" title="valid: True, node: 6, tag: ul, level: 6" node_number="6"> <li class="valid" valid="valid" title="valid: True, node: 7, tag: li, level: 7" node_number="7"> <a class="valid" valid="valid" title="valid: True, node: 8, tag: a, level: 8" node_number="8">Articles</a> </li> </ul> <div class="valid" valid="valid" title="valid: True, node: 9, tag: div, level: 6" node_number="9"> <a class="valid" valid="valid" title="valid: True, node: 10, tag: a, level: 7" node_number="10"> RSS Feed </a></div> </div> </header> </div> </div> <main class="valid" valid="valid" title="valid: True, node: 11, tag: main, level: 2" node_number="11"> <div class="valid" valid="valid" title="valid: True, node: 12, tag: div, level: 3" node_number="12"> <div class="valid" valid="valid" title="valid: True, node: 13, tag: div, level: 4" node_number="13"> <header class="valid" valid="valid" title="valid: True, node: 14, tag: header, level: 5" node_number="14"> <h1 class="valid" valid="valid" title="valid: True, node: 15, tag: h1, level: 6" node_number="15"> The road to production ready charts </h1> <div class="valid" valid="valid" title="valid: True, node: 16, tag: div, level: 6" node_number="16"> <p class="valid" valid="valid" title="valid: True, node: 17, tag: p, level: 7" node_number="17"> Published by <b class="valid" valid="valid" title="valid: True, node: 18, tag: b, level: 8" node_number="18"> Javier J. Salmer&#243;n </b> on <time class="valid" valid="valid" title="valid: True, node: 19, tag: time, level: 8" node_number="19"> May 13, 2019 </time> </p> <div class="valid" valid="valid" title="valid: True, node: 20, tag: div, level: 7" node_number="20"> #kubernetes #helm #charts #production-ready #security #elasticsearch #rabbitmq #postgresql </div> </div> </header> </div> <div class="valid" valid="valid" title="valid: True, node: 21, tag: div, level: 4" node_number="21"> <div class="valid" valid="valid" title="valid: True, node: 22, tag: div, level: 5" node_number="22"> <p class="valid" valid="valid" title="valid: True, node: 23, tag: p, level: 6" node_number="23">Three years have passed since <a class="valid" valid="valid" title="valid: True, node: 24, tag: a, level: 7" node_number="24">the first release of Helm</a>, and it has indeed made a name for itself. Both avowed fans and fervent haters agree that the Kubernetes "apt-get equivalent" is the standard way of deploying to production (at least for now, let's see what Operators end up bringing to the table). During this time, Bitnami has contributed to the project in many ways. You can find us in PRs in Helm's code, in solutions like <a class="valid" valid="valid" title="valid: True, node: 25, tag: a, level: 7" node_number="25">Kubeapps</a>, and especially in what we are mostly known for: <a class="valid" valid="valid" title="valid: True, node: 26, tag: a, level: 7" node_number="26">our huge application library</a>.</p> <p class="valid" valid="valid" title="valid: True, node: 27, tag: p, level: 6" node_number="27">As maintainers of a collection of more than <a class="valid" valid="valid" title="valid: True, node: 28, tag: a, level: 7" node_number="28">45 Helm charts</a>, we know that creating a maintainable, secure and production-ready chart is far from trivial. In this sense, this blog post shows essential features that any chart developer should know.</p> <h3 class="valid" valid="valid" title="valid: True, node: 29, tag: h3, level: 6" node_number="29">Use non-root containers</h3> <p class="valid" valid="valid" title="valid: True, node: 30, tag: p, level: 6" node_number="30">Ensuring that a container is able to perform only a very limited set of operations is vital for production deployments. This is possible thanks to the use of non-root containers, which are executed by a user different from root. Although creating a non-root container is a bit more complex than a root container (especially regarding filesystem permissions), it is absolutely worth it. Also, in environments like Openshift, <a class="valid" valid="valid" title="valid: True, node: 31, tag: a, level: 7" node_number="31">using non-root containers is mandatory</a>.</p> <p class="valid" valid="valid" title="valid: True, node: 32, tag: p, level: 6" node_number="32">In order to make your Helm chart work with non-root containers, add the <a class="valid" valid="valid" title="valid: True, node: 33, tag: a, level: 7" node_number="33">securityContext</a> section to your yaml files.</p> <p class="valid" valid="valid" title="valid: True, node: 34, tag: p, level: 6" node_number="34">This is what we do, for instance, in the Bitnami Elasticsearch Helm chart. This chart deploys several Elasticsearch StatefulSets and Deployments (data, ingestion, coordinating and master nodes), all of them with non-root containers. If we check the <a class="valid" valid="valid" title="valid: True, node: 35, tag: a, level: 7" node_number="35">master node StatefulSet</a>, we see the following:</p> <div class="valid" valid="valid" title="valid: True, node: 36, tag: div, level: 6" node_number="36"><pre class="valid" valid="valid" title="valid: True, node: 37, tag: pre, level: 7" node_number="37"><code class="valid" valid="valid" title="valid: True, node: 38, tag: code, level: 8" node_number="38">spec: {{- if .Values.securityContext.enabled }} securityContext: fsGroup: {{ .Values.securityContext.fsGroup }} {{- end }} </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 39, tag: p, level: 6" node_number="39">The snippet above changes the permissions of the mounted volumes, so the container user can access them for read/write operations. In addition to this, inside the container definition, we see another securityContext block:</p> <div class="valid" valid="valid" title="valid: True, node: 40, tag: div, level: 6" node_number="40"><pre class="valid" valid="valid" title="valid: True, node: 41, tag: pre, level: 7" node_number="41"><code class="valid" valid="valid" title="valid: True, node: 42, tag: code, level: 8" node_number="42">{{- if .Values.securityContext.enabled }} securityContext: runAsUser: {{ .Values.securityContext.runAsUser }} {{- end }} </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 43, tag: p, level: 6" node_number="43">In this part we specify the user running the container. In the values.yaml file we set the default values for these parameters:</p> <div class="valid" valid="valid" title="valid: True, node: 44, tag: div, level: 6" node_number="44"><pre class="valid" valid="valid" title="valid: True, node: 45, tag: pre, level: 7" node_number="45"><code class="valid" valid="valid" title="valid: True, node: 46, tag: code, level: 8" node_number="46">## Pod Security Context ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/security-context/ ## securityContext: enabled: true fsGroup: 1001 runAsUser: 1001 </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 47, tag: p, level: 6" node_number="47">With these changes, the chart will work as non-root in platforms like GKE, Minikube or Openshift.</p> <h3 class="valid" valid="valid" title="valid: True, node: 48, tag: h3, level: 6" node_number="48">Do not persist the configuration</h3> <p class="valid" valid="valid" title="valid: True, node: 49, tag: p, level: 6" node_number="49">Adding persistence is an essential part of deploying stateful applications. In our experience, deciding what or what not to persist can be tricky. After several iterations in our charts, we found that persisting the application configuration is not a recommended practice. One advantage of Kubernetes is that you can change the deployment parameters very easily by just doing <code class="valid" valid="valid" title="valid: True, node: 50, tag: code, level: 7" node_number="50">kubectl edit deployment</code> or <code class="valid" valid="valid" title="valid: True, node: 51, tag: code, level: 7" node_number="51">helm upgrade</code>. If the configuration is persisted, none of the changes would be applied. So, when developing a production-ready Helm chart, make sure that the configuration can be easily changed with <code class="valid" valid="valid" title="valid: True, node: 52, tag: code, level: 7" node_number="52">kubectl</code> or <code class="valid" valid="valid" title="valid: True, node: 53, tag: code, level: 7" node_number="53">helm upgrade</code>. One common practice is to create a ConfigMap with the configuration and have it mounted in the container. Let's use the Bitnami RabbitMQ chart as an example:</p> <div class="valid" valid="valid" title="valid: True, node: 54, tag: div, level: 6" node_number="54"><pre class="valid" valid="valid" title="valid: True, node: 55, tag: pre, level: 7" node_number="55"><code class="valid" valid="valid" title="valid: True, node: 56, tag: code, level: 8" node_number="56">apiVersion: v1 kind: ConfigMap metadata: name: {{ template "rabbitmq.fullname" . }}-config labels: app: {{ template "rabbitmq.name" . }} chart: {{ template "rabbitmq.chart" . }} release: "{{.Release.Name}}" heritage: "{{.Release.Service }}" data: enabled_plugins: |- {{ template "rabbitmq.plugins" . }} rabbitmq.conf: |- ##username and password default_user={{.Values.rabbitmq.username}} default_pass=CHANGEME {{ .Values.rabbitmq.configuration | indent 4 }} {{ .Values.rabbitmq.extraConfiguration | indent 4 }} </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 57, tag: p, level: 6" node_number="57">Note that there is a section in the values.yaml file that allows you to include any custom configuration:</p> <div class="valid" valid="valid" title="valid: True, node: 58, tag: div, level: 6" node_number="58"><pre class="valid" valid="valid" title="valid: True, node: 59, tag: pre, level: 7" node_number="59"><code class="valid" valid="valid" title="valid: True, node: 60, tag: code, level: 8" node_number="60"> ## Configuration file content: required cluster configuration ## Do not override unless you know what you are doing. To add more configuration, use `extraConfiguration` instead configuration: |- ## Clustering cluster_formation.peer_discovery_backend = rabbit_peer_discovery_k8s cluster_formation.k8s.host = kubernetes.default.svc.cluster.local cluster_formation.node_cleanup.interval = 10 cluster_formation.node_cleanup.only_log_warning = true cluster_partition_handling = autoheal # queue master locator queue_master_locator=min-masters # enable guest user loopback_users.guest = false ## Configuration file content: extra configuration ## Use this instead of `configuration` to add more configuration extraConfiguration: |- #disk_free_limit.absolute = 50MB #management.load_definitions = /app/load_definition.json </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 61, tag: p, level: 6" node_number="61">This ConfigMap then gets mounted in the container filesystem, as we can see in the StatefulSet spec:</p> <div class="valid" valid="valid" title="valid: True, node: 62, tag: div, level: 6" node_number="62"><pre class="valid" valid="valid" title="valid: True, node: 63, tag: pre, level: 7" node_number="63"><code class="valid" valid="valid" title="valid: True, node: 64, tag: code, level: 8" node_number="64">volumes: - name: config-volume configMap: name: {{ template "rabbitmq.fullname" . }}-config items: - key: rabbitmq.conf path: rabbitmq.conf - key: enabled_plugins path: enabled_plugins </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 65, tag: p, level: 6" node_number="65">If the application needs to write in the configuration file, then you'll need to create a copy inside the container, as ConfigMaps are mounted as read-only. This is done in the RabbitMQ deployment as well:</p> <div class="valid" valid="valid" title="valid: True, node: 66, tag: div, level: 6" node_number="66"><pre class="valid" valid="valid" title="valid: True, node: 67, tag: pre, level: 7" node_number="67"><code class="valid" valid="valid" title="valid: True, node: 68, tag: code, level: 8" node_number="68">containers: - name: rabbitmq image: {{ template "rabbitmq.image" . }} imagePullPolicy: {{ .Values.image.pullPolicy | quote }} command: - bash - -ec - | mkdir -p /opt/bitnami/rabbitmq/.rabbitmq/ mkdir -p /opt/bitnami/rabbitmq/etc/rabbitmq/ #persist the erlang cookie in both places for server and cli tools echo $RABBITMQ_ERL_COOKIE &gt; /opt/bitnami/rabbitmq/var/lib/rabbitmq/.erlang.cookie cp /opt/bitnami/rabbitmq/var/lib/rabbitmq/.erlang.cookie /opt/bitnami/rabbitmq/.rabbitmq/ #change permission so only the user has access to the cookie file chmod 600 /opt/bitnami/rabbitmq/.rabbitmq/.erlang.cookie /opt/bitnami/rabbitmq/var/lib/rabbitmq/.erlang.cookie #copy the mounted configuration to both places cp /opt/bitnami/rabbitmq/conf/* /opt/bitnami/rabbitmq/etc/rabbitmq # Apply resources limits ulimit -n "${RABBITMQ_ULIMIT_NOFILES}" #replace the default password that is generated sed -i "s/CHANGEME/$RABBITMQ_PASSWORD/g" /opt/bitnami/rabbitmq/etc/rabbitmq/rabbitmq.conf </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 69, tag: p, level: 6" node_number="69">This will make your chart not only easy to upgrade, but also more adaptable to user needs, as they can provide their custom configuration file.</p> <h3 class="valid" valid="valid" title="valid: True, node: 70, tag: h3, level: 6" node_number="70">Integrate charts with logging and monitoring tools</h3> <p class="valid" valid="valid" title="valid: True, node: 71, tag: p, level: 6" node_number="71">If we are talking about production environments, we are talking about observability. It is essential having our deployments properly monitored so we can early detect potential issues. It also essential to have application usage, cost and resource consumption metrics. In order to gather this information, you would commonly deploy logging stacks like EFK (ElasticSearch, Fluentd, and Kibana) and monitoring tools like Prometheus. Bitnami offers the Bitnami Kubernetes Production Runtime (BKPR) that easily installs these tools (along with others) so your cluster is ready to handle production workloads.</p> <p class="valid" valid="valid" title="valid: True, node: 72, tag: p, level: 6" node_number="72">When writing your chart, make sure that your deployment is able to work with the above tools seamlessly. To do so, ensure the following:</p> <ul class="valid" valid="valid" title="valid: True, node: 73, tag: ul, level: 6" node_number="73"> <li class="valid" valid="valid" title="valid: True, node: 74, tag: li, level: 7" node_number="74">All the containers log to stdout/stderr (so the EFK stack can easily ingest all the logging information)</li> <li class="valid" valid="valid" title="valid: True, node: 75, tag: li, level: 7" node_number="75">Prometheus exporters are included (either using sidecar containers or having a separate deployment)</li> </ul> <p class="valid" valid="valid" title="valid: True, node: 76, tag: p, level: 6" node_number="76">All Bitnami charts work with BKPR (which includes EFK and Prometheus) out of the box. Let's take a look at the Bitnami PostgreSQL chart and Bitnami PostgreSQL container to see how we did it.</p> <p class="valid" valid="valid" title="valid: True, node: 77, tag: p, level: 6" node_number="77">To begin with, the process inside the container runs at the foreground, so all the logging information is written in stdout/stderr:</p> <div class="valid" valid="valid" title="valid: True, node: 78, tag: div, level: 6" node_number="78"><pre class="valid" valid="valid" title="valid: True, node: 79, tag: pre, level: 7" node_number="79"><code class="valid" valid="valid" title="valid: True, node: 80, tag: code, level: 8" node_number="80">START_ARGS=("-D" "$DATA_DIR" "--config-file=$CONF_FILE" "--external_pid_file=$PID_FILE" "--hba_file=$PG_HBA_FILE") STOP_ARGS=("stop" "-w" "-D" "$DATA_DIR") function postgresqlStart { # If container is started as `root` user if [ $EUID -eq 0 ]; then exec gosu postgres postgres "${START_ARGS[@]}" else exec postgres "${START_ARGS[@]}" fi } </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 81, tag: p, level: 6" node_number="81">With this, we ensured that it works with EFK. Then, in the chart we added a sidecar container for the Prometheus metrics:</p> <div class="valid" valid="valid" title="valid: True, node: 82, tag: div, level: 6" node_number="82"><pre class="valid" valid="valid" title="valid: True, node: 83, tag: pre, level: 7" node_number="83"><code class="valid" valid="valid" title="valid: True, node: 84, tag: code, level: 8" node_number="84">{{- if .Values.metrics.enabled }} - name: metrics image: {{ template "postgresql.metrics.image" . }} imagePullPolicy: {{ .Values.metrics.image.pullPolicy | quote }} {{- if .Values.metrics.securityContext.enabled }} securityContext: runAsUser: {{ .Values.metrics.securityContext.runAsUser }} {{- end }} env: {{- $database := required "In order to enable metrics you need to specify a database (.Values.postgresqlDatabase or .Values.global.postgresql.postgresqlDatabase)" (include "postgresql.database" .) }} - name: DATA_SOURCE_URI value: {{ printf "127.0.0.1:%d/%s?sslmode=disable" (int (include "postgresql.port" .)) $database | quote }} </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 85, tag: p, level: 6" node_number="85">We also made sure that the pods or services contain the proper annotations that Prometheus uses to detect exporters. In this case, we defined them in the values.yaml file:</p> <div class="valid" valid="valid" title="valid: True, node: 86, tag: div, level: 6" node_number="86"><pre class="valid" valid="valid" title="valid: True, node: 87, tag: pre, level: 7" node_number="87"><code class="valid" valid="valid" title="valid: True, node: 88, tag: code, level: 8" node_number="88">## Configure metrics exporter ## metrics: enabled: true # resources: {} service: type: ClusterIP annotations: prometheus.io/scrape: "true" prometheus.io/port: "9187" </code></pre></div> <p class="valid" valid="valid" title="valid: True, node: 89, tag: p, level: 6" node_number="89">In the case of the PostgreSQL chart, these annotations go to a <a class="valid" valid="valid" title="valid: True, node: 90, tag: a, level: 7" node_number="90">metrics service</a>, separate from the PostgreSQL service.</p> <p class="valid" valid="valid" title="valid: True, node: 91, tag: p, level: 6" node_number="91">With these modifications, your chart will seamlessly integrate with your monitoring platform. All the obtained metrics will be crucial for maintaining the deployment in good shape.</p> <h3 class="valid" valid="valid" title="valid: True, node: 92, tag: h3, level: 6" node_number="92">Production workloads in Kubernetes are possible</h3> <p class="valid" valid="valid" title="valid: True, node: 93, tag: p, level: 6" node_number="93">Now you know some essential guidelines for creating secured (with non-root containers), adaptable (with proper configuration management), and observable (with proper monitoring) charts. With these features, you have covered the basics to ensure that your application can be deployed to production. However, this is just another step in your journey to mastering Helm. You should also take into account other features like upgradability, usability, stability and testing.</p> <h3 class="valid" valid="valid" title="valid: True, node: 94, tag: h3, level: 6" node_number="94">Useful Links</h3> <p class="valid" valid="valid" title="valid: True, node: 95, tag: p, level: 6" node_number="95">To learn more, check the following links:</p> <ul class="valid" valid="valid" title="valid: True, node: 96, tag: ul, level: 6" node_number="96"> <li class="valid" valid="valid" title="valid: True, node: 97, tag: li, level: 7" node_number="97"><a class="valid" valid="valid" title="valid: True, node: 98, tag: a, level: 8" node_number="98">Official Helm chart good practice guidelines</a></li> <li class="valid" valid="valid" title="valid: True, node: 99, tag: li, level: 7" node_number="99"><a class="valid" valid="valid" title="valid: True, node: 100, tag: a, level: 8" node_number="100">Helm best practices by CodeFresh</a></li> <li class="valid" valid="valid" title="valid: True, node: 101, tag: li, level: 7" node_number="101"><a class="valid" valid="valid" title="valid: True, node: 102, tag: a, level: 8" node_number="102">Bitnami Kubernetes Production Runtime</a></li> <li class="valid" valid="valid" title="valid: True, node: 103, tag: li, level: 7" node_number="103"><a class="valid" valid="valid" title="valid: True, node: 104, tag: a, level: 8" node_number="104">Bitnami Helm charts library in Github</a></li> <li class="valid" valid="valid" title="valid: True, node: 105, tag: li, level: 7" node_number="105"><a class="valid" valid="valid" title="valid: True, node: 106, tag: a, level: 8" node_number="106">Kubeapps Hub</a></li> </ul> <div class="valid" valid="valid" title="valid: True, node: 107, tag: div, level: 6" node_number="107"> <a class="valid" valid="valid" title="valid: True, node: 108, tag: a, level: 7" node_number="108">Meet us at KubeCon</a> </div> </div> <div class="valid" valid="valid" title="valid: True, node: 109, tag: div, level: 5" node_number="109"> <p class="valid" valid="valid" title="valid: True, node: 110, tag: p, level: 6" node_number="110">Did you like this article? Share it with your friends.</p> <ul class="valid" valid="valid" title="valid: True, node: 111, tag: ul, level: 6" node_number="111"> <li class="valid" valid="valid" title="valid: True, node: 112, tag: li, level: 7" node_number="112"> <a class="valid" valid="valid" title="valid: True, node: 113, tag: a, level: 8" node_number="113">(not found) </a></li> </ul> </div> <div class="valid" valid="valid" title="valid: True, node: 114, tag: div, level: 5" node_number="114"> <h3 class="valid" valid="valid" title="valid: True, node: 115, tag: h3, level: 6" node_number="115">About the author</h3> <div class="valid" valid="valid" title="valid: True, node: 116, tag: div, level: 6" node_number="116"> <h2 class="valid" valid="valid" title="valid: True, node: 117, tag: h2, level: 7" node_number="117"> Javier J. Salmer&#243;n </h2> </div> </div> </div> </div> </main> </body>
        <style tyle='text/css'>
body{
    position: relative;
    padding-left: 30px;
    top: 60px;
}
* {
    border: 1px solid #eee;
    padding: 5px 12px;
    margin: 3px 0;
    box-sizing: content-box;
    background-color: #fff;
    cursor: no-drop;
}
main:hover > *, section:hover > *, header:hover > *, nav:hover > *, a:hover > *, div:hover > *, p:hover > *, ul:hover > *, h1:hover > *, h2:hover > *, h3:hover > *, li:hover > *, span:hover > *{
    border: 2px solid green;
    background-color: #fffeee;
    padding: 5px 23px !important;
    margin: 1px 0;
    color: green;
}
main:hover, section:hover, header:hover, nav:hover, a:hover, div:hover, p:hover, ul:hover, h1:hover, h2:hover, h3:hover, li:hover, span:hover{
    border: 1px solid #fff;
    background-color: #eee;
}
a, span {
    display: block;
}
.selected {
    border: 2px solid orchid !important;
    opacity: 0.8;
    color: orchid !important;
}
.selected * {
    padding: 2px !important;
    color: orchid !important;
}
.valid {
  cursor: pointer;
}
.btn{
  cursor: pointer;
  font-weight: bolder;
  padding: 8px;
}
</style> 
        <script>function OpenOriginalLink($event){
    $event.stopPropagation();
    console.log(url);
}

function removeItem($event){
    $event.stopPropagation();
    console.log('Remove item: ', url)
    localStorage.removeItem(url)
}

function exportData($event){
    $event.stopPropagation();

    result = []
    for(let i=0; i<localStorage.length; i++) {
        let key = localStorage.key(i);
        result.push(localStorage.getItem(key))
    }
    const _url = URL.createObjectURL(new Blob([result.join("\n")], {type: 'text/plain'}))
    $event.target.href = _url;
    localStorage.clear()
}

var removeItemBtn = document.createElement("BUTTON");   // Create a <button> element
removeItemBtn.innerHTML = "Remove Item";
removeItemBtn.classList.add('btn');
removeItemBtn.style.position = "fixed";
removeItemBtn.style.left = '5px';
removeItemBtn.style.top = 0;
removeItemBtn.style.border = "1px solid";
removeItemBtn.style.boxShadow = "3px 3px #888";
removeItemBtn.onclick = removeItem;
document.body.appendChild(removeItemBtn);

var goToOriginLink = document.createElement("A");   // Create a <button> element
goToOriginLink.innerHTML = "GoToOrigin";
goToOriginLink.classList.add('btn');
goToOriginLink.style.position = "fixed"
goToOriginLink.style.left = '115px'
goToOriginLink.style.top = 0;
goToOriginLink.onclick = OpenOriginalLink;
goToOriginLink.setAttribute('href', decodeURIComponent(url));
goToOriginLink.target = '_blank';
document.body.appendChild(goToOriginLink);

var current = new Date
var exportDataLink = document.createElement("A");   // Create a <button> element
exportDataLink.innerHTML = "Export data";
exportDataLink.classList.add('btn');
exportDataLink.download = current.toISOString() + '.exported.txt';
exportDataLink.style.position = "fixed";
exportDataLink.style.right = '5px';
exportDataLink.style.top = 0;
exportDataLink.style.border = "1px solid #888";
exportDataLink.style.boxShadow = "3px 3px #888";
exportDataLink.onclick = exportData;
document.body.appendChild(exportDataLink);

data = {
    'title': null ,
    'article': null
}

var body = document.getElementsByTagName("body")[0];

body.onclick = function($e){
    var num = $e.target.getAttribute('node_number')
    var valid = $e.target.getAttribute('valid')

    if(!valid){
        console.log("Element is invalid")
        return
    }

    if(data.length > 2){
        data = data.splice(0, 2)
    }

    console.log("node:", $e.target)

    if(!data.title && !data.article){
        data.title = num;
        console.log("data:", data)
        $e.target.classList.add('selected')
    }else if (data.title && !data.article){
        data.article = num;
        console.log("data:", data)
        $e.target.classList.add('selected')
    }else{
        selected = Array.from(document.getElementsByClassName("selected"))
        selected.forEach(function(el){
            el.classList.remove('selected')
        })

        data.title = num;
        data.article = null;
        $e.target.classList.add('selected')

    }

    if(data.title && data.article){
        var obj = {
            url: url,
            text: body_html,
            title: data.title,
            article: data.article,
        }

        var datasetItem = JSON.stringify(obj)
        localStorage.setItem(url, datasetItem)
    }
}
</script> 
      </html>